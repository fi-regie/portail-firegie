<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz du R√©gisseur </title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Font Awesome pour ic√¥nes -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Palette "Architectural Safety" -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Palette du mod√®le
                        'stone': {
                            50: '#fafaf9',
                            100: '#f5f5f4',
                            200: '#e7e5e4',
                            300: '#d6d3d1',
                            400: '#a8a29e',
                            500: '#78716c',
                            600: '#57534e',
                            700: '#44403c',
                            800: '#292524',
                            900: '#1c1917',
                        },
                        'orange': {
                            600: '#ea580c',
                        },
                        'emerald': {
                            600: '#059669',
                        },
                        'slate': {
                            700: '#334155',
                        }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>

        body {
            font-family: 'Inter', sans-serif;
            background-color: #fafaf9 !important;
            color: var(--color-primary);
            scroll-behavior: auto !important;
        }

        /* Custom Chart Container Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Hide scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Animation for fade in */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        /* Professional Chart Containers */
        .chart-container-professional {
            position: relative;
            width: 100%;
            margin: 0 auto;
            height: 400px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Tab transitions */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }

        /* Quiz specific styles */
        .quiz-option {
            transition: all 0.2s ease;
        }

        .quiz-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px -2px rgba(0, 0, 0, 0.1);
        }

        .quiz-option.selected {
            border-color: #059669;
            background-color: #f0fdf4;
        }

        .quiz-option.correct {
            border-color: #059669;
            background-color: #f0fdf4;
        }

        .quiz-option.incorrect {
            border-color: #dc2626;
            background-color: #fef2f2;
        }
    </style>
</head>

<body class="bg-stone-50 text-stone-800 font-sans antialiased selection:bg-orange-200 selection:text-orange-900">

    <!-- Navigation / Header -->
    <nav class="bg-white border-b border-stone-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl mr-2"></span>
                    <h1 class="text-xl font-bold tracking-tight text-slate-700"> Quiz du R√©gisseur 
                        <span class="text-orange-600 text-sm font-normal uppercase ml-2 tracking-widest">CTS & ERP Type L</span></h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="hidden md:flex items-center space-x-2">
                        <span class="text-sm text-stone-500">Temps √©coul√© :</span>
                        <div class="bg-stone-100 px-3 py-1 rounded-lg font-mono font-bold text-slate-700" id="globalTimer">00:00</div>
                    </div>
                    <div class="h-3 w-3 rounded-full bg-emerald-500 animate-pulse" title="Application active"></div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Navigation professionnelle -->
    <div class="bg-white border-b border-stone-200">
        <div class="max-w-8xl mx-auto">
            <nav class="flex overflow-x-auto no-scrollbar px-4">
                <button onclick="switchTab('config')"
                    class="nav-btn px-4 py-3 border-b-2 border-transparent hover:border-orange-600 hover:text-orange-600 whitespace-nowrap flex items-center"
                    id="btn-config">
                    <i class="fas fa-cog mr-2"></i>Configuration
                </button>
                <button onclick="switchTab('resultats')"
                    class="nav-btn px-4 py-3 border-b-2 border-transparent hover:border-emerald-600 hover:text-emerald-600 whitespace-nowrap flex items-center"
                    id="btn-resultats">
                    <i class="fas fa-chart-line mr-2"></i>R√©sultats
                </button>
            </nav>
        </div>
    </div>

    <main class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- ONGLET 1 : CONFIGURATION -->
        <div id="config" class="tab-content active">
            <div class="max-w-6xl mx-auto">
                <!-- Introduction -->
                <div class="bg-white rounded-xl shadow-sm border border-stone-100 p-6 md:p-8 mb-8">
                    <h2 class="text-2xl font-semibold mb-4 text-slate-700">üöÄ Configuration du Quiz CTS Pro</h2>
                    <p class="text-stone-600 leading-relaxed mb-6">
                        Personnalisez votre session d'entra√Ænement selon vos besoins. Ce quiz interactif vous permet de tester vos connaissances sur la r√©glementation des Chapiteaux, Tentes et Structures (CTS) de mani√®re progressive et p√©dagogique.
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                        <div class="bg-stone-50 p-4 rounded-lg border-l-4 border-orange-500">
                            <span class="block text-xs font-bold text-stone-400 uppercase tracking-wider mb-1">Objectif 1</span>
                            <span class="font-medium">Valider vos connaissances CTS</span>
                        </div>
                        <div class="bg-stone-50 p-4 rounded-lg border-l-4 border-slate-600">
                            <span class="block text-xs font-bold text-stone-400 uppercase tracking-wider mb-1">Objectif 2</span>
                            <span class="font-medium">Identifier vos points d'am√©lioration</span>
                        </div>
                        <div class="bg-stone-50 p-4 rounded-lg border-l-4 border-emerald-500">
                            <span class="block text-xs font-bold text-stone-400 uppercase tracking-wider mb-1">Objectif 3</span>
                            <span class="font-medium">Obtenir une certification professionnelle</span>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- SECTION 1 : Nombre de questions -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-list-ol text-orange-600 mr-3"></i>
                            Nombre de questions
                        </h3>
                        <p class="text-sm text-stone-500 mb-4">Choisissez la dur√©e de votre session</p>
                        <div class="space-y-3" id="questionCountOptions">
                            <!-- Les options seront g√©n√©r√©es dynamiquement -->
                        </div>
                    </div>

                    <!-- SECTION 2 : Niveau de difficult√© -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-trophy text-orange-600 mr-3"></i>
                            Niveau de difficult√©
                        </h3>
                        <p class="text-sm text-stone-500 mb-4">Adaptez la complexit√© des questions</p>
                        <div class="space-y-3" id="levelOptions">
                            <!-- Les options seront g√©n√©r√©es dynamiquement -->
                        </div>
                    </div>

                    <!-- SECTION 3 : Th√®mes du quiz -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-book-open text-orange-600 mr-3"></i>
                            Th√®mes du quiz
                        </h3>
                        <p class="text-sm text-stone-500 mb-4">S√©lectionnez les domaines √† tester</p>
                        <div class="space-y-3" id="themeOptions">
                            <!-- Les options seront g√©n√©r√©es dynamiquement -->
                        </div>
                    </div>
                </div>

                <!-- R√©sum√© de configuration -->
                <div class="mt-8 bg-emerald-50 rounded-xl p-6 border-l-4 border-emerald-500">
                    <h4 class="text-lg font-bold text-emerald-800 mb-3 flex items-center">
                        <i class="fas fa-check-circle mr-3"></i>
                        R√©sum√© de votre configuration
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="configSummary">
                        <div>
                            <div class="font-bold text-stone-700">Questions :</div>
                            <div class="text-emerald-700 font-medium" id="summaryQuestions">20</div>
                        </div>
                        <div>
                            <div class="font-bold text-stone-700">Niveau :</div>
                            <div class="text-emerald-700 font-medium" id="summaryLevel">Professionnel</div>
                        </div>
                        <div>
                            <div class="font-bold text-stone-700">Th√®mes :</div>
                            <div class="text-emerald-700 font-medium" id="summaryThemes">4 s√©lectionn√©s</div>
                        </div>
                    </div>
                </div>

                <!-- Bouton de d√©marrage -->
                <div class="mt-12 text-center">
                    <button onclick="startQuiz()"
                            class="bg-gradient-to-r from-orange-600 to-orange-700 text-white font-bold py-4 px-12 rounded-lg hover:from-orange-700 hover:to-orange-800 transition text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                        <i class="fas fa-rocket mr-3"></i>
                        üöÄ D√©marrer le quiz
                    </button>
                    <p class="text-sm text-stone-500 mt-4">
                        <i class="fas fa-info-circle mr-2"></i>
                        Temps estim√© : <span id="estimatedTime" class="font-bold">10-15 minutes</span>
                    </p>
                </div>
            </div>
        </div>

        <!-- ONGLET 2 : QUIZ -->
        <div id="quiz" class="tab-content">
            <div class="max-w-6xl mx-auto">
                <!-- Barre de progression et statistiques -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="text-center p-4 bg-stone-50 rounded-lg border border-stone-200">
                            <div class="text-2xl font-bold text-slate-800" id="currentQuestion">1/20</div>
                            <div class="text-sm text-stone-600">Question</div>
                        </div>
                        <div class="text-center p-4 bg-emerald-50 rounded-lg border border-emerald-200">
                            <div class="text-2xl font-bold text-emerald-800" id="correctAnswers">0</div>
                            <div class="text-sm text-emerald-700">Correctes</div>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <div class="text-2xl font-bold text-blue-800" id="scorePercentage">0%</div>
                            <div class="text-sm text-blue-700">Score</div>
                        </div>
                        <div class="text-center p-4 bg-orange-50 rounded-lg border border-orange-200">
                            <div class="text-2xl font-bold text-orange-800" id="questionsLeft">20</div>
                            <div class="text-sm text-orange-700">Restantes</div>
                        </div>
                    </div>

                    <!-- Barre de progression d√©taill√©e -->
                    <div class="mb-4">
                        <div class="flex justify-between text-sm text-stone-600 mb-2">
                            <span>Progression</span>
                            <span id="progressText">0%</span>
                        </div>
                        <div class="h-3 bg-stone-200 rounded-full overflow-hidden">
                            <div id="progressBar" class="h-full bg-gradient-to-r from-orange-500 to-orange-600 transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Question actuelle -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                    <div class="flex justify-between items-start mb-6">
                        <div>
                            <div class="inline-block px-3 py-1 bg-slate-100 text-slate-700 rounded-full text-sm font-bold mb-3" id="questionTheme">S√âCURIT√â</div>
                            <h3 class="text-2xl font-bold text-slate-800" id="questionText">Chargement de la question...</h3>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-stone-500 mb-1">Difficult√©</div>
                            <div class="flex space-x-1">
                                <div class="w-3 h-3 rounded-full bg-stone-300"></div>
                                <div class="w-3 h-3 rounded-full bg-stone-300"></div>
                                <div class="w-3 h-3 rounded-full bg-stone-300"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Options de r√©ponse -->
                    <div class="space-y-4 mb-8" id="quizOptions">
                        <!-- Les options seront inject√©es par JavaScript -->
                    </div>

                    <!-- Indices et aides -->
                    <div class="bg-blue-50 rounded-lg p-4 border-l-4 border-blue-500 mb-6 hidden" id="hintContainer">
                        <div class="flex items-start">
                            <i class="fas fa-lightbulb text-blue-600 text-xl mr-3 mt-1"></i>
                            <div>
                                <h4 class="font-bold text-blue-800 mb-1">Indice p√©dagogique</h4>
                                <p class="text-blue-700" id="hintText"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Feedback de r√©ponse -->
                    <div class="mb-6 hidden" id="feedbackContainer">
                        <!-- Le feedback sera inject√© par JavaScript -->
                    </div>

                    <!-- √âtude de cas li√©e -->
                    <div class="bg-stone-50 rounded-lg p-4 border-l-4 border-slate-600 hidden" id="caseStudyContainer">
                        <h4 class="font-bold text-slate-800 mb-2 flex items-center">
                            <i class="fas fa-balance-scale mr-2"></i>
                            √âtude de Cas Li√©e
                        </h4>
                        <div id="caseStudyContent"></div>
                    </div>

                    <!-- R√©f√©rences l√©gales -->
                    <div class="bg-stone-50 rounded-lg p-4 hidden" id="referenceContainer">
                        <h4 class="font-bold text-stone-800 mb-2 flex items-center">
                            <i class="fas fa-book mr-2"></i>
                            R√©f√©rence l√©gale
                        </h4>
                        <p class="text-sm text-stone-600" id="referenceText"></p>
                        <a href="#" target="_blank" class="text-sm text-blue-600 hover:underline inline-block mt-2" id="referenceLink">
                            <i class="fas fa-external-link-alt mr-1"></i>
                            Consulter le texte
                        </a>
                    </div>
                </div>

                <!-- Contr√¥les de navigation -->
                <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                    <div class="flex space-x-4">
                        <button onclick="showHint()"
                                class="flex items-center px-5 py-3 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition">
                            <i class="fas fa-lightbulb mr-2"></i>
                            Afficher un indice
                        </button>
                    </div>
                    
                    <div class="flex space-x-4">
                        <button onclick="previousQuestion()"
                                class="flex items-center px-6 py-3 bg-stone-100 text-stone-700 rounded-lg hover:bg-stone-200 transition disabled:opacity-50 disabled:cursor-not-allowed"
                                id="prevBtn" disabled>
                            <i class="fas fa-arrow-left mr-2"></i>
                            Pr√©c√©dent
                        </button>
                        <button onclick="nextQuestionOrFinish()"
                                class="flex items-center px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition"
                                id="nextBtn">
                            Suivant
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ONGLET 3 : √âTUDES DE CAS R√âELS -->
        <div id="cas_reels" class="tab-content">
            <div class="max-w-6xl mx-auto">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold mb-2 text-slate-800">√âtudes de Cas R√©els - CTS</h2>
                    <p class="text-stone-600 mb-6">
                        Analysez des situations r√©elles issues de jurisprudence. Ces cas concrets illustrent les cons√©quences des non-conformit√©s et renforcent votre compr√©hension op√©rationnelle.
                    </p>
                </div>

                <!-- Cas r√©els - Contenu dynamique -->
                <div id="caseStudiesContent">
                    <!-- Les √©tudes de cas seront charg√©es dynamiquement -->
                </div>
            </div>
        </div>

        <!-- ONGLET 4 : CLASSIFICATION & RESPONSABILIT√â -->
        <div id="classification" class="tab-content">
            <div class="max-w-6xl mx-auto">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold mb-2 text-slate-800">Classification CTS & Responsabilit√©</h2>
                    <p class="text-stone-600 mb-6">
                        La classification des CTS d√©termine les obligations r√©glementaires sp√©cifiques.
                        En tant que responsable, votre vigilance conditionne la s√©curit√© des personnes.
                    </p>
                </div>

                <!-- Contenu dynamique -->
                <div id="classificationContent">
                    <!-- Le contenu sera charg√© dynamiquement -->
                </div>
            </div>
        </div>

        <!-- ONGLET 5 : D√âGAGEMENTS -->
        <div id="degagements" class="tab-content">
            <div class="max-w-6xl mx-auto">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold mb-2 text-slate-800">D√©gagements CTS : La Vie en Jeu</h2>
                    <p class="text-stone-600 mb-6">
                        Les d√©gagements dans les CTS pr√©sentent des particularit√©s li√©es √† la nature temporaire et textile des structures.
                    </p>
                </div>

                <!-- Contenu dynamique -->
                <div id="degagementsContent">
                    <!-- Le contenu sera charg√© dynamiquement -->
                </div>
            </div>
        </div>

        <!-- ONGLET 6 : MAT√âRIAUX -->
        <div id="materiaux" class="tab-content">
            <div class="max-w-6xl mx-auto">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold mb-2 text-slate-800">Mat√©riaux CTS : L'Expertise Technique</h2>
                    <p class="text-stone-600 mb-6">
                        Les mat√©riaux utilis√©s dans les CTS doivent r√©pondre √† des exigences particuli√®res de r√©action au feu.
                    </p>
                </div>

                <!-- Contenu dynamique -->
                <div id="materiauxContent">
                    <!-- Le contenu sera charg√© dynamiquement -->
                </div>
            </div>
        </div>

        <!-- ONGLET 7 : SECOURS -->
        <div id="secours" class="tab-content">
            <div class="max-w-6xl mx-auto">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold mb-2 text-slate-800">Organisation des Secours en CTS</h2>
                    <p class="text-stone-600 mb-6">
                        L'organisation des secours dans les CTS n√©cessite une adaptation aux contraintes sp√©cifiques des structures d√©montables.
                    </p>
                </div>

                <!-- Contenu dynamique -->
                <div id="secoursContent">
                    <!-- Le contenu sera charg√© dynamiquement -->
                </div>
            </div>
        </div>

        <!-- ONGLET 8 : R√âSULTATS -->
        <div id="resultats" class="tab-content">
            <div class="max-w-6xl mx-auto">
                <!-- Sceau de validation -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-8 text-center border border-stone-200">
                    <i class="fas fa-award text-6xl text-emerald-600 mb-4"></i>
                    <h2 class="text-3xl font-bold mb-4 text-slate-800">R√©sultats du Quiz CTS</h2>
                    <p class="text-lg text-stone-600">
                        Analyse d√©taill√©e de vos performances et recommandations personnalis√©es.
                    </p>
                </div>

                <!-- Score et statistiques -->
                <div id="resultsContainer" class="hidden">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                            <div class="text-4xl font-bold text-emerald-600" id="finalScorePercentage">0%</div>
                            <div class="text-sm text-stone-600">Score final</div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                            <div class="text-4xl font-bold text-emerald-600" id="totalCorrectAnswers">0</div>
                            <div class="text-sm text-stone-600">R√©ponses correctes</div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                            <div class="text-4xl font-bold text-stone-600" id="totalTimeTaken">00:00</div>
                            <div class="text-sm text-stone-600">Temps total</div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                            <div class="text-4xl font-bold text-orange-600" id="averageTime">0s</div>
                            <div class="text-sm text-stone-600">Temps moyen/question</div>
                        </div>
                    </div>

                    <!-- Graphique de performance -->
                    <div class="bg-white p-6 rounded-xl shadow-sm mb-8">
                        <h3 class="text-xl font-bold mb-4">Analyse par th√®me</h3>
                        <div class="chart-container-professional">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>

                    <!-- Recommandations -->
                    <div class="bg-orange-50 rounded-xl p-6 border-l-4 border-orange-500 mb-8">
                        <h4 class="text-2xl font-bold mb-4">Plan d'am√©lioration</h4>
                        <ul class="space-y-3" id="adviceList">
                            <!-- Les conseils seront inject√©s par JavaScript -->
                        </ul>
                    </div>

                    <!-- Certificat -->
                    <div class="bg-gradient-to-r from-slate-800 to-slate-700 text-white rounded-xl p-8 shadow-sm mb-8">
                        <div class="text-center">
                            <i class="fas fa-certificate text-5xl text-emerald-300 mb-4"></i>
                            <h3 class="text-2xl font-bold mb-6">Certificat de Formation</h3>
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 max-w-2xl mx-auto">
                                <p class="mb-4">Atteste que</p>
                                <div class="text-3xl font-bold mb-6 border-b border-white/30 pb-4" contenteditable="true" id="certificateName">[VOTRE NOM]</div>
                                <p class="mb-2">a suivi avec succ√®s la formation</p>
                                <p class="text-xl font-bold mb-6">"Quiz CTS Pro - R√©glementation Chapiteaux, Tentes et Structures"</p>
                                <div class="grid grid-cols-2 gap-6 text-sm">
                                    <div>
                                        <div class="font-bold text-emerald-300">Score obtenu</div>
                                        <div id="certificateScore">0%</div>
                                    </div>
                                    <div>
                                        <div class="font-bold text-emerald-300">Date</div>
                                        <div id="certificateDate"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Boutons d'action -->
                    <div class="flex flex-col md:flex-row justify-center gap-4">
                        <button onclick="downloadCertificate()"
                                class="bg-emerald-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-emerald-700 transition flex items-center justify-center">
                            <i class="fas fa-download mr-2"></i>
                            T√©l√©charger le certificat
                        </button>
                        <button onclick="restartQuiz()"
                                class="bg-slate-800 text-white font-bold py-3 px-8 rounded-lg hover:bg-slate-900 transition flex items-center justify-center">
                            <i class="fas fa-redo mr-2"></i>
                            Nouveau quiz
                        </button>
                    </div>
                </div>

                <!-- Message si pas encore de quiz -->
                <div id="noResultsMessage" class="text-center py-12">
                    <i class="fas fa-clipboard-list text-5xl text-stone-400 mb-4"></i>
                    <h4 class="text-xl font-bold text-stone-600">Aucun r√©sultat disponible</h4>
                    <p class="text-stone-500">Commencez un quiz pour voir vos r√©sultats ici</p>
                    <button onclick="switchTab('config')"
                            class="mt-6 bg-orange-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-orange-700 transition">
                        <i class="fas fa-cog mr-2"></i>
                        Configurer un quiz
                    </button>
                </div>
            </div>
        </div>

    </main>

        <!-- Pied de page -->
    <footer class="bg-[#e9ecef] text-[#495057] py-8 mt-12 border-t border-[#dee2e6]">
        <div class="max-w-8xl mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>

                <!-- Section 1 -->
                    <h4 class="text-xl mb-4 text-[#343a40]">Portail de veille juridique ERP & CTS</h4>
                    <p class="text-[#6c757d] text-sm mb-2">
                        Suite d'Applications destin√©es aux
                        R√©gisseurs, Exploitants & Organismes de Formation
                    </p>

                    <p class="text-[#495057] text-sm font-medium mb-2 mt-4">
                        L'Application ne se substitue pas :
                    </p>
                    <ul class="text-[#6c757d] text-sm space-y-1 mb-4">
                        <li>‚Ä¢ Aux textes officiels publi√©s</li>
                        <li>‚Ä¢ √Ä l'avis d'experts certifi√©s</li>
                        <li>‚Ä¢ Aux commissions de s√©curit√© comp√©tentes</li>
                        <li>‚Ä¢ √Ä la jurisprudence en vigueur</li>
                    </ul>
                    
                    <p class="text-[#6c757d] text-sm">
                        <small>Mise √† jour : 27 d√©cembre 2025</small>
                    </p>
                </div>

                <!-- Section 2 -->
                <div class="md:border- md:border-[] md:pl-8">
                    <h4 class="text-xl mb-4 text-[#343a40]">Applications</h4>

                    <div class="space-y-4">
                        <a href="https://fi-regie.github.io/portail-firegie/index.html#accueil" target="_blank"
                            class="flex items-start text-[#495057] hover:text-[#0d6efd] transition">
                            <i class="fas fa-external-link-alt mr-2 mt-1"></i>
                            <div>
                                <h5 class="text-[0.95rem] font-medium">Portail de veille juridique ERP & CTS</h5>                                <p class="text-sm text-[#6c757d] mt-1">
                                    Suite d'Applications destin√©e aux
                                    R√©gisseurs, Exploitants & Organismes de Formation
                                </p>
                            </div>
                        </a>

                        <a href="https://fi-regie.github.io/portail-firegie/apps/reglementation-cts/index.html" target="_blank"
                            class="flex items-start text-[#495057] hover:text-[#0d6efd] transition">
                            <i class="fas fa-external-link-alt mr-2 mt-1"></i>
                            <div>
                                <h5>R√©glementation Spectacle Itin√©rant</h5>
                                <p class="text-sm text-[#6c757d] mt-1">
                                    Outils de veille juridique & de s√©curit√© du Spectacle Itin√©rant
                                </p>
                            </div>
                        </a>

                        <a href="https://fi-regie.github.io/portail-firegie/apps/simulation/index.html" target="_blank"
                            class="flex items-start text-[#495057] hover:text-[#0d6efd] transition">
                            <i class="fas fa-external-link-alt mr-2 mt-1"></i>
                            <div>
                                <h5 class="text-[0.95rem] font-medium">Outil de Simulation S√©curit√©</h5>
                                <p class="text-sm text-[#6c757d] mt-1">
                                    Simulez votre Cat√©gorie ERP, vos d√©gagements UP, √âch. de Beaufort
                                </p>
                            </div>
                        </a>

                        <a href="https://fi-regie.github.io/portail-firegie/apps/reglementation-erp/index.html" target="_blank"
                            class="flex items-start text-[#495057] hover:text-[#0d6efd] transition">
                            <i class="fas fa-external-link-alt mr-2 mt-1"></i>
                            <div>
                                <h5>R√©glementation ERP</h5>
                                <p class="text-sm text-[#6c757d] mt-1">
                                    Application interactive des textes officiels pour consulter rapidement la
                                    R√®glementation ERP (CCH, Arr√™t√© du 25 juin 1980)
                                </p>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Section 3 -->
                <div class="md:border- md:border-[] md:pl-8">
                    <h4 class="text-xl mb-4 text-[#343a40]">Formation</h4>
                    <div class="space-y-4">
                        <a href="https://fi-regie.github.io/portail-firegie/apps/focus-reglementation/index.html" target="_blank"
                            class="flex items-start text-[#495057] hover:text-[#0d6efd] transition">
                            <i class="fas fa-external-link-alt mr-2 mt-1"></i>
                            <div>
                                <h5 class="text-[0.95rem] font-medium">Focus R√©glementation</h5>
                                <p class="text-sm text-[#6c757d] mt-1">
                                    Guide pour comprendre l'architecture de la 
                                    r√©glementation officielle ERP
                                </p>
                            </div>
                        </a>

                        <a href="https://fi-regie.github.io/portail-firegie/apps/securite-incendie/index.html" target="_blank"
                            class="flex items-start text-[#495057] hover:text-[#0d6efd] transition">
                            <i class="fas fa-external-link-alt mr-2 mt-1"></i>
                            <div>
                                <h5>Guide de la S√©curit√© Incendie</h5>
                                <p class="text-sm text-[#6c757d] mt-1">
                                    Synth√©se des obligations des recponsables de la s√©curit√© incendie ERP  
                                </p>
                            </div>
                        </a>

                        <a href="https://fi-regie.github.io/portail-firegie/apps/formation-securite/index.html" target="_blank"
                            class="flex items-start text-[#495057] hover:text-[#0d6efd] transition">
                            <i class="fas fa-external-link-alt mr-2 mt-1"></i>
                            <div>
                                <h5>Formation S√©curit√© ERP</h5>
                                <p class="text-sm text-[#6c757d] mt-1">
                                    Outil p√©dagogique destin√© √† la formation des responsables techniques
                                    d'ERP Type L & CTS.
                                </p>
                            </div>
                        </a>

                        <a href="https://fi-regie.github.io/portail-firegie/apps/quiz/index.html" target="_blank"
                            class="flex items-start text-[#495057] hover:text-[#0d6efd] transition">
                            <i class="fas fa-external-link-alt mr-2 mt-1"></i>
                            <div>
                                <h5>Le Quiz du R√©gisseur</h5>
                                <p class="text-sm text-[#6c757d] mt-1">
                                    Amusez-vous, apprenez, √©valuez vos comp√©tences
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <div class="mt-8 pt-8 border-t border-[#ced4da] text-center text-sm text-[#6c757d]">
                <p>
                    <i class="fas fa-gavel mr-2"></i>
                    Portail de veille juridique CTS & ERP Type L
                </p>
                <p class="mt-2">
                    ¬©Ô∏èOpen Source ‚Ä¢ Partage & Contribution ‚Ä¢ Contact :
                    philippe.potier-regie@proton.me
                </p>
            </div>
        </div>
    </footer>

    <script>
        // --- CONFIGURATION SIMPLIFI√âE ---
        
        // Options de configuration
        const configOptions = {
            questionCounts: [
                { value: 10, label: "10 questions", time: "5-10 min", default: false },
                { value: 20, label: "20 questions", time: "10-15 min", default: true },
                { value: 30, label: "30 questions", time: "15-20 min", default: false }
            ],
            levels: [
                { value: "student", label: "√âtudiant", icon: "fa-user-graduate", default: false },
                { value: "pro", label: "Professionnel", icon: "fa-user-tie", default: true },
                { value: "expert", label: "Expert", icon: "fa-crown", default: false }
            ],
            themes: [
                { value: "general", label: "G√©n√©ralit√©s CTS", icon: "üèóÔ∏è", default: true },
                { value: "construction", label: "Construction", icon: "üî®", default: true },
                { value: "electricity", label: "√âlectricit√©", icon: "‚ö°", default: true },
                { value: "safety", label: "S√©curit√©", icon: "üö®", default: true }
            ]
        };

        // √âtat de configuration
        const quizConfig = {
            questionCount: 20,
            level: "pro",
            selectedThemes: ["general", "construction", "electricity", "safety"]
        };

        // --- INITIALISATION DE LA CONFIGURATION ---
        function initConfiguration() {
            // G√©n√©rer les options de nombre de questions
            const questionCountContainer = document.getElementById('questionCountOptions');
            configOptions.questionCounts.forEach(option => {
                const isSelected = quizConfig.questionCount === option.value;
                const div = document.createElement('div');
                div.className = `quiz-option p-4 border rounded-lg cursor-pointer transition ${isSelected ? 'border-orange-500 bg-orange-50' : 'border-stone-300 hover:bg-stone-50'}`;
                div.dataset.value = option.value;
                div.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="font-medium">${option.label}</div>
                            <div class="text-sm text-stone-500">${option.time}</div>
                        </div>
                        ${isSelected ? '<i class="fas fa-check text-orange-600"></i>' : ''}
                    </div>
                `;
                div.addEventListener('click', () => selectQuestionCount(option.value));
                questionCountContainer.appendChild(div);
            });

            // G√©n√©rer les options de niveau
            const levelContainer = document.getElementById('levelOptions');
            configOptions.levels.forEach(option => {
                const isSelected = quizConfig.level === option.value;
                const div = document.createElement('div');
                div.className = `quiz-option p-4 border rounded-lg cursor-pointer transition ${isSelected ? 'border-orange-500 bg-orange-50' : 'border-stone-300 hover:bg-stone-50'}`;
                div.dataset.value = option.value;
                div.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas ${option.icon} mr-3 ${isSelected ? 'text-orange-600' : 'text-stone-500'}"></i>
                        <div class="flex-1">
                            <div class="font-medium">${option.label}</div>
                        </div>
                        ${isSelected ? '<i class="fas fa-check text-orange-600"></i>' : ''}
                    </div>
                `;
                div.addEventListener('click', () => selectLevel(option.value));
                levelContainer.appendChild(div);
            });

            // G√©n√©rer les options de th√®mes
            const themeContainer = document.getElementById('themeOptions');
            configOptions.themes.forEach(option => {
                const isSelected = quizConfig.selectedThemes.includes(option.value);
                const div = document.createElement('div');
                div.className = `quiz-option p-3 border rounded-lg cursor-pointer transition ${isSelected ? 'border-emerald-500 bg-emerald-50' : 'border-stone-300 hover:bg-stone-50'}`;
                div.dataset.value = option.value;
                div.innerHTML = `
                    <div class="flex items-center">
                        <span class="text-xl mr-3">${option.icon}</span>
                        <div class="flex-1 font-medium">${option.label}</div>
                        ${isSelected ? '<i class="fas fa-check text-emerald-600"></i>' : ''}
                    </div>
                `;
                div.addEventListener('click', () => toggleTheme(option.value));
                themeContainer.appendChild(div);
            });

            // Mettre √† jour le r√©sum√©
            updateConfigSummary();
        }

        // --- GESTION DES S√âLECTIONS ---
        function selectQuestionCount(count) {
            quizConfig.questionCount = count;
            
            // Mettre √† jour l'interface
            document.querySelectorAll('#questionCountOptions .quiz-option').forEach(option => {
                const optionValue = parseInt(option.dataset.value);
                if (optionValue === count) {
                    option.classList.add('border-orange-500', 'bg-orange-50');
                    option.classList.remove('border-stone-300');
                } else {
                    option.classList.remove('border-orange-500', 'bg-orange-50');
                    option.classList.add('border-stone-300');
                }
                
                // Mettre √† jour l'ic√¥ne de v√©rification
                const checkIcon = option.querySelector('.fa-check');
                if (checkIcon) {
                    checkIcon.style.display = optionValue === count ? 'block' : 'none';
                }
            });
            
            updateConfigSummary();
            updateEstimatedTime();
        }

        function selectLevel(level) {
            quizConfig.level = level;
            
            // Mettre √† jour l'interface
            document.querySelectorAll('#levelOptions .quiz-option').forEach(option => {
                if (option.dataset.value === level) {
                    option.classList.add('border-orange-500', 'bg-orange-50');
                    option.classList.remove('border-stone-300');
                } else {
                    option.classList.remove('border-orange-500', 'bg-orange-50');
                    option.classList.add('border-stone-300');
                }
                
                // Mettre √† jour l'ic√¥ne de v√©rification
                const checkIcon = option.querySelector('.fa-check');
                if (checkIcon) {
                    checkIcon.style.display = option.dataset.value === level ? 'block' : 'none';
                }
            });
            
            updateConfigSummary();
        }

        function toggleTheme(theme) {
            const index = quizConfig.selectedThemes.indexOf(theme);
            if (index === -1) {
                quizConfig.selectedThemes.push(theme);
            } else {
                quizConfig.selectedThemes.splice(index, 1);
            }
            
            // Mettre √† jour l'interface
            document.querySelectorAll('#themeOptions .quiz-option').forEach(option => {
                if (option.dataset.value === theme) {
                    const isSelected = quizConfig.selectedThemes.includes(theme);
                    if (isSelected) {
                        option.classList.add('border-emerald-500', 'bg-emerald-50');
                        option.classList.remove('border-stone-300');
                    } else {
                        option.classList.remove('border-emerald-500', 'bg-emerald-50');
                        option.classList.add('border-stone-300');
                    }
                    
                    // Mettre √† jour l'ic√¥ne de v√©rification
                    const checkIcon = option.querySelector('.fa-check');
                    if (checkIcon) {
                        checkIcon.style.display = isSelected ? 'block' : 'none';
                    }
                }
            });
            
            updateConfigSummary();
        }

        function updateConfigSummary() {
            document.getElementById('summaryQuestions').textContent = quizConfig.questionCount;
            
            // Trouver le label du niveau
            const levelOption = configOptions.levels.find(l => l.value === quizConfig.level);
            document.getElementById('summaryLevel').textContent = levelOption ? levelOption.label : quizConfig.level;
            
            document.getElementById('summaryThemes').textContent = `${quizConfig.selectedThemes.length} s√©lectionn√©(s)`;
        }

        function updateEstimatedTime() {
            const times = {
                10: "5-10 minutes",
                20: "10-15 minutes",
                30: "15-20 minutes"
            };
            document.getElementById('estimatedTime').textContent = times[quizConfig.questionCount] || "10-15 minutes";
        }

        // --- BASE DE DONN√âES √âTENDUE DES QUESTIONS ---
        const questionsDatabase = {
            student: [
                {
                    id: 1,
                    theme: 'GENERAL',
                    question: "Quelle est la d√©finition r√©glementaire d'un chapiteau selon l'arr√™t√© CTS ?",
                    options: [
                        "Structure textile soutenue par des m√¢ts et des c√¢bles",
                        "Toute structure temporaire d√©montable",
                        "B√¢timent l√©ger de moins de 50m¬≤",
                        "Structure en toile sans ancrage"
                    ],
                    correctAnswer: 0,
                    hint: "L'arr√™t√© du 23 janvier 1985 d√©finit pr√©cis√©ment les diff√©rentes cat√©gories de CTS.",
                    explanation: "Un chapiteau est d√©fini comme une structure textile soutenue par des m√¢ts et des c√¢bles, selon l'article 1 de l'arr√™t√© du 23 janvier 1985.",
                    detailedExplanation: "Cette d√©finition distingue le chapiteau des tentes et structures. La sp√©cificit√© 'textile soutenue par des m√¢ts et c√¢bles' est essentielle pour appliquer les bonnes r√®gles de s√©curit√©.",
                    reference: "Arr√™t√© du 23 janvier 1985, article 1",
                    link: "https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000000864644",
                    caseStudy: "En 2018, un festival a √©t√© sanctionn√© pour avoir pr√©sent√© une structure m√©tallique comme un chapiteau, contournant ainsi les r√®gles CTS sp√©cifiques."
                },
                {
                    id: 2,
                    theme: 'CONSTRUCTION',
                    question: "Quelle est la distance minimale entre un chapiteau et un b√¢timent existant ?",
                    options: [
                        "3 m√®tres",
                        "5 m√®tres",
                        "10 m√®tres",
                        "Aucune distance minimale n'est impos√©e"
                    ],
                    correctAnswer: 1,
                    hint: "Cette distance permet l'acc√®s des secours et limite les risques de propagation d'incendie.",
                    explanation: "Une distance minimale de 5 m√®tres est requise pour permettre l'acc√®s des secours et √©viter la propagation d'incendie.",
                    detailedExplanation: "Ces 5 m√®tres sont critiques pour : 1) L'acc√®s des engins de secours 2) La pr√©vention de la propagation du feu 3) L'√©vacuation s√©curis√©e",
                    reference: "Arr√™t√© du 23 janvier 1985, article 10",
                    link: "https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000000864644",
                    caseStudy: "Lors d'un incendie √† Marseille en 2019, l'impossibilit√© d'acc√®s des pompiers due √† une distance insuffisante a aggrav√© les d√©g√¢ts."
                },
                {
                    id: 3,
                    theme: '√âLECTRICIT√â',
                    question: "Quelle norme √©lectrique s'applique aux installations temporaires de CTS ?",
                    options: [
                        "NFC 15-100 uniquement",
                        "NF C 15-500 uniquement",
                        "NFC 15-100 et NF C 15-500",
                        "Aucune norme sp√©cifique"
                    ],
                    correctAnswer: 2,
                    hint: "Les installations temporaires combinent les exigences des normes permanentes et temporaires.",
                    explanation: "Les installations doivent respecter √† la fois la NFC 15-100 (bases) et la NF C 15-500 (sp√©cificit√©s temporaires).",
                    detailedExplanation: "La NFC 15-500 compl√®te la 15-100 avec des dispositions pour : installations d√©montables, protection contre les intemp√©ries, c√¢bles souples autoris√©s.",
                    reference: "NF C 15-500 - Installations √©lectriques temporaires",
                    link: "https://www.boutique.afnor.org/fr-fr/norme/nf-c15500",
                    caseStudy: "En 2021, un court-circuit dans une installation non conforme a provoqu√© un incendie dans un chapiteau de 500 places."
                },
                {
                    id: 4,
                    theme: 'S√âCURIT√â',
                    question: "Quel est le classement au feu minimum pour les toiles de chapiteau ?",
                    options: [
                        "M0 (incombustible)",
                        "M1 (non inflammable)",
                        "M2 (difficilement inflammable)",
                        "M3 (moyennement inflammable)"
                    ],
                    correctAnswer: 1,
                    hint: "Consultez les articles relatifs √† la r√©action au feu des mat√©riaux textiles.",
                    explanation: "La toile des chapiteaux doit √™tre class√©e M1 (non inflammable) ou M2 ignifug√©.",
                    detailedExplanation: "Le classement M1 signifie : indice d'oxyg√®ne ‚â• 28, essai au chalumeau - pas de gouttes enflamm√©es.",
                    reference: "Arr√™t√© du 23 janvier 1985, article 15",
                    link: "https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000000864644",
                    caseStudy: "L'incendie du chapiteau de Dijon en 2020 a √©t√© aggrav√© par une toile class√©e M3."
                },
                {
                    id: 5,
                    theme: 'GENERAL',
                    question: "√Ä partir de combien de personnes un chapiteau devient un ERP de 5√®me cat√©gorie ?",
                    options: [
                        "50 personnes",
                        "100 personnes",
                        "200 personnes",
                        "300 personnes"
                    ],
                    correctAnswer: 2,
                    hint: "Le seuil de 200 personnes est d√©terminant pour la classification CTS.",
                    explanation: "Un chapiteau de plus de 200 personnes rel√®ve de la 5√®me cat√©gorie ERP.",
                    detailedExplanation: "Seuil sp√©cifique CTS : > 200 personnes = 5√®me cat√©gorie. Cons√©quences : visites commission possibles, registre de s√©curit√© obligatoire.",
                    reference: "Arr√™t√© du 23 janvier 1985, article 3",
                    link: "https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000000864644",
                    caseStudy: "Un organisateur a √©t√© condamn√© pour ne pas avoir d√©clar√© son chapiteau de 220 places comme ERP 5√®me cat√©gorie."
                },
                {
                    id: 6,
                    theme: 'CONSTRUCTION',
                    question: "Quelle est la hauteur maximale d'un chapiteau sans autorisation sp√©ciale ?",
                    options: [
                        "8 m√®tres",
                        "12 m√®tres",
                        "15 m√®tres",
                        "20 m√®tres"
                    ],
                    correctAnswer: 1,
                    hint: "Cette limitation concerne la stabilit√© et la s√©curit√© au vent.",
                    explanation: "La hauteur maximale est de 12 m√®tres sans autorisation sp√©ciale.",
                    detailedExplanation: "Au-del√† de 12m, des √©tudes de stabilit√© particuli√®res sont requises, notamment pour la r√©sistance au vent.",
                    reference: "Guide technique CTS - Minist√®re de l'Int√©rieur",
                    caseStudy: "En 2022, un chapiteau de 18m a d√ª √™tre d√©mont√© pour non-respect de cette hauteur maximale."
                },
                {
                    id: 7,
                    theme: '√âLECTRICIT√â',
                    question: "Quelle est la section minimale des conducteurs en cuivre pour l'√©clairage ?",
                    options: [
                        "1,5 mm¬≤",
                        "2,5 mm¬≤",
                        "4 mm¬≤",
                        "6 mm¬≤"
                    ],
                    correctAnswer: 1,
                    hint: "La section d√©pend de l'usage et de la longueur du circuit.",
                    explanation: "La section minimale est de 2,5 mm¬≤ pour les circuits d'√©clairage en cuivre.",
                    detailedExplanation: "Cette section permet de limiter la chute de tension et d'assurer la s√©curit√© √©lectrique.",
                    reference: "NFC 15-100, tableau 52-C",
                    caseStudy: "Un incendie en 2020 a √©t√© caus√© par une surchauffe due √† des c√¢bles de 1,5 mm¬≤ sur un circuit de 3kW."
                },
                {
                    id: 8,
                    theme: 'S√âCURIT√â',
                    question: "Combien faut-il d'extincteurs pour un chapiteau de 400 m¬≤ ?",
                    options: [
                        "1 extincteur",
                        "2 extincteurs",
                        "3 extincteurs",
                        "4 extincteurs"
                    ],
                    correctAnswer: 1,
                    hint: "La r√®gle est : 1 extincteur pour 200 m¬≤ ou fraction.",
                    explanation: "Il faut 2 extincteurs (400 m¬≤ √∑ 200 m¬≤ = 2).",
                    detailedExplanation: "Ces extincteurs doivent √™tre de type eau + additif 6L, accessibles en moins de 15 secondes de marche.",
                    reference: "Article MS 54 - R√®glement de s√©curit√©",
                    caseStudy: "Lors d'un d√©part de feu en 2019, l'absence du deuxi√®me extincteur a retard√© l'intervention."
                },
                {
                    id: 9,
                    theme: 'GENERAL',
                    question: "Quelle est la dur√©e maximale d'installation d'un CTS sans permis de construire ?",
                    options: [
                        "1 mois",
                        "3 mois",
                        "6 mois",
                        "12 mois"
                    ],
                    correctAnswer: 1,
                    hint: "Au-del√† de cette dur√©e, l'installation devient consid√©r√©e comme permanente.",
                    explanation: "La dur√©e maximale est de 3 mois sans permis de construire.",
                    detailedExplanation: "Ce d√©lai peut √™tre prolong√© sur autorisation sp√©ciale de la mairie, avec justification.",
                    reference: "Code de l'urbanisme, article R*421-19",
                    caseStudy: "Une soci√©t√© a √©t√© condamn√©e pour avoir maintenu un chapiteau 5 mois sans autorisation."
                },
                {
                    id: 10,
                    theme: 'CONSTRUCTION',
                    question: "Quelle charge au sol minimale doit supporter un chapiteau ?",
                    options: [
                        "150 kg/m¬≤",
                        "200 kg/m¬≤",
                        "250 kg/m¬≤",
                        "300 kg/m¬≤"
                    ],
                    correctAnswer: 2,
                    hint: "Cette charge inclut le public, le mobilier et les √©quipements.",
                    explanation: "La charge au sol minimale est de 250 kg/m¬≤.",
                    detailedExplanation: "Cette valeur correspond √† un public debout dense avec √©quipements l√©gers.",
                    reference: "NF P 98-001 - Charges permanentes et d'exploitation",
                    caseStudy: "L'effondrement partiel d'une estrade en 2018 √©tait d√ª √† une charge de seulement 180 kg/m¬≤."
                }
            ],
            pro: [
                {
                    id: 101,
                    theme: 'S√âCURIT√â',
                    question: "Pour un chapiteau de 800 places, quel est le classement au feu minimum requis pour la toile ?",
                    options: [
                        "M0 (incombustible)",
                        "M1 (non inflammable)",
                        "M2 (difficilement inflammable)",
                        "M3 (moyennement inflammable)"
                    ],
                    correctAnswer: 1,
                    hint: "Consultez les articles relatifs √† la r√©action au feu des mat√©riaux textiles.",
                    explanation: "La toile des chapiteaux doit √™tre class√©e M1 (non inflammable) ou M2 ignifug√©, selon l'article 15 de l'arr√™t√© du 23 janvier 1985.",
                    detailedExplanation: "Le classement M1 signifie : indice d'oxyg√®ne ‚â• 28, essai au chalumeau - pas de gouttes enflamm√©es, temps de combustion ‚â§ 5 secondes.",
                    reference: "Arr√™t√© du 23 janvier 1985, article 15",
                    link: "https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000000864644",
                    caseStudy: "L'incendie du chapiteau de Dijon en 2020 a √©t√© aggrav√© par une toile class√©e M3 au lieu de M1, propagation en 90 secondes."
                },
                {
                    id: 102,
                    theme: 'CLASSIFICATION',
                    question: "Un chapiteau accueillant 250 personnes rel√®ve-t-il de la 5√®me cat√©gorie ?",
                    options: [
                        "Oui, toujours",
                        "Non, jamais",
                        "Oui si implant√© en plein air",
                        "D√©pend de la hauteur sous toile"
                    ],
                    correctAnswer: 0,
                    hint: "Le seuil de 200 personnes est d√©terminant pour la classification CTS.",
                    explanation: "Oui, un chapiteau de plus de 200 personnes rel√®ve de la 5√®me cat√©gorie ERP, quelle que soit son implantation.",
                    detailedExplanation: "Seuil sp√©cifique CTS : > 200 personnes = 5√®me cat√©gorie. Cons√©quences : visites commission possibles, registre de s√©curit√© obligatoire.",
                    reference: "Arr√™t√© du 23 janvier 1985, article 3",
                    link: "https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000000864644",
                    caseStudy: "Un organisateur a √©t√© condamn√© pour ne pas avoir d√©clar√© son chapiteau de 220 places comme ERP 5√®me cat√©gorie."
                },
                {
                    id: 103,
                    theme: 'D√âGAGEMENTS',
                    question: "Combien faut-il de sorties pour un chapiteau de 600 personnes ?",
                    options: [
                        "2 sorties minimum",
                        "3 sorties minimum", 
                        "4 sorties minimum",
                        "5 sorties minimum"
                    ],
                    correctAnswer: 1,
                    hint: "La r√®gle est : 2 sorties jusqu'√† 500 personnes, puis +1 sortie par tranche de 500 personnes.",
                    explanation: "Il faut 3 sorties minimum : 2 pour les premi√®res 500 personnes + 1 pour les 100 personnes suppl√©mentaires.",
                    detailedExplanation: "Calcul : 600 personnes = 2 sorties (base) + 1 sortie suppl√©mentaire (d√©passement 500). Largeur cumul√©e minimale : 600/100 = 6 UP √ó 0.60m = 3.60m.",
                    reference: "Article CO 38 - R√®glement de s√©curit√©",
                    link: "https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000000290033",
                    caseStudy: "En 2017, l'√©vacuation difficile d'un chapiteau surcharg√© (1 sortie pour 550 personnes) a fait 8 bless√©s."
                },
                {
                    id: 104,
                    theme: '√âLECTRICIT√â',
                    question: "Quelle est la distance maximale entre deux prises de courant en CTS ?",
                    options: [
                        "2 m√®tres",
                        "4 m√®tres",
                        "6 m√®tres",
                        "8 m√®tres"
                    ],
                    correctAnswer: 1,
                    hint: "Cette distance limite l'usage de rallonges dangereuses.",
                    explanation: "La distance maximale est de 4 m√®tres entre deux prises de courant.",
                    detailedExplanation: "Cette r√®gle vise √† √©viter les rallonges multiples et les risques de tr√©buchement.",
                    reference: "NF C 15-500, article 559.5",
                    caseStudy: "En 2019, une chute avec blessure due √† un enchev√™trement de rallonges sur 10 m√®tres."
                },
                {
                    id: 105,
                    theme: 'CONSTRUCTION',
                    question: "Quel type d'ancrage est obligatoire pour un chapiteau en zone vent√©e ?",
                    options: [
                        "Ancrages en b√©ton",
                        "Plot-b√©ton de 500kg",
                        "Ancrages viss√©s ou enterr√©s",
                        "Contrepoids en eau"
                    ],
                    correctAnswer: 2,
                    hint: "Les ancrages doivent r√©sister aux efforts de soul√®vement.",
                    explanation: "Des ancrages viss√©s ou enterr√©s sont obligatoires en zone vent√©e.",
                    detailedExplanation: "Ces ancrages doivent √™tre calcul√©s pour r√©sister √† un vent de 120 km/h selon la zone.",
                    reference: "DTU 43.1 - R√®gles NV 65",
                    caseStudy: "En 2018, un chapiteau ancr√© avec des sacs de sable a √©t√© arrach√© par un vent de 100 km/h."
                },
                {
                    id: 106,
                    theme: 'MAT√âRIAUX',
                    question: "Quelle est la dur√©e de validit√© d'un certificat d'ignifugation pour toile de chapiteau ?",
                    options: [
                        "1 an",
                        "3 ans",
                        "5 ans",
                        "Illimit√©e si bien entretenue"
                    ],
                    correctAnswer: 2,
                    hint: "L'ignifugation perd son efficacit√© avec le temps et les conditions m√©t√©orologiques.",
                    explanation: "La dur√©e de validit√© est g√©n√©ralement de 5 ans, mais doit √™tre v√©rifi√©e annuellement en conditions s√©v√®res.",
                    detailedExplanation: "Facteurs r√©duisant la dur√©e : UV, pluie acide, frottements, nettoyages. Contr√¥le annuel recommand√© par test au chalumeau.",
                    reference: "Guide technique CTS - Minist√®re de l'Int√©rieur",
                    caseStudy: "Incendie de Nantes 2019 : toile ignifug√©e il y a 7 ans, efficacit√© nulle, propagation en 2 minutes."
                },
                {
                    id: 107,
                    theme: 'SECOURS',
                    question: "Quel est le d√©lai maximum d'intervention des secours int√©gr√© dans le plan d'√©vacuation ?",
                    options: [
                        "5 minutes",
                        "10 minutes",
                        "15 minutes",
                        "30 minutes"
                    ],
                    correctAnswer: 1,
                    hint: "Ce d√©lai correspond au temps d'√©vacuation complet de la structure.",
                    explanation: "Le plan d'√©vacuation doit pr√©voir une √©vacuation compl√®te en moins de 10 minutes.",
                    detailedExplanation: "Calcul bas√© sur : temps de d√©tection (2 min) + alerte (1 min) + √©vacuation (6 min) + marge (1 min) = 10 minutes max.",
                    reference: "Article MS 46 - R√®glement de s√©curit√©",
                    link: "https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000000290033",
                    caseStudy: "Exercice r√©ussi √† Strasbourg : 850 personnes √©vacu√©es en 8 minutes 30 gr√¢ce √† un plan bien pr√©par√©."
                },
                {
                    id: 108,
                    theme: 'JURISPRUDENCE',
                    question: "Selon la jurisprudence, quelle est la responsabilit√© du responsable technique en cas d'effondrement d√ª √† des ancrages d√©fectueux ?",
                    options: [
                        "Responsabilit√© civile uniquement",
                        "Responsabilit√© p√©nale pour mise en danger d'autrui",
                        "Aucune responsabilit√© si le constructeur est fautif",
                        "Responsabilit√© administrative uniquement"
                    ],
                    correctAnswer: 1,
                    hint: "L'article 223-1 du Code p√©nal s'applique en cas de violation d√©lib√©r√©e des obligations de s√©curit√©.",
                    explanation: "Le responsable technique engage sa responsabilit√© p√©nale (article 223-1 CP) s'il a manqu√© √† son obligation de v√©rification des ancrages.",
                    detailedExplanation: "La jurisprudence consid√®re que le responsable technique doit v√©rifier personnellement les points critiques : ancrages, stabilit√©, conformit√© des mat√©riaux.",
                    reference: "Code p√©nal, article 223-1",
                    link: "https://www.legifrance.gouv.fr/codes/article_lc/LEGIARTI000006417884/",
                    caseStudy: "Tribunal correctionnel de Lyon, 2020 : 6 mois avec sursis + 15 000‚Ç¨ d'amende pour non-contr√¥le des ancrages."
                },
                {
                    id: 109,
                    theme: '√âLECTRICIT√â',
                    question: "Quelle est la tension maximale autoris√©e pour les installations temporaires en CTS ?",
                    options: [
                        "230V monophas√©",
                        "400V triphas√©",
                        "500V",
                        "1000V"
                    ],
                    correctAnswer: 1,
                    hint: "La tension d√©pend des besoins en puissance des √©quipements.",
                    explanation: "La tension maximale est de 400V triphas√© pour les installations temporaires.",
                    detailedExplanation: "Cette tension permet d'alimenter des √©quipements puissants (sono, lumi√®res) tout en respectant les limites de s√©curit√©.",
                    reference: "NF C 15-500, article 559.1",
                    caseStudy: "En 2021, une installation en 500V a provoqu√© un arc √©lectrique et un d√©part de feu."
                },
                {
                    id: 110,
                    theme: 'S√âCURIT√â',
                    question: "Quelle est la distance maximale √† parcourir pour atteindre un extincteur ?",
                    options: [
                        "10 m√®tres",
                        "15 m√®tres",
                        "20 m√®tres",
                        "25 m√®tres"
                    ],
                    correctAnswer: 1,
                    hint: "Cette distance garantit une intervention rapide en cas de d√©part de feu.",
                    explanation: "La distance maximale est de 15 m√®tres √† parcourir jusqu'√† un extincteur.",
                    detailedExplanation: "Calcul bas√© sur un temps d'intervention de 30 secondes maximum pour un d√©part de feu naissant.",
                    reference: "Article MS 54 - R√®glement de s√©curit√©",
                    caseStudy: "Lors d'un incendie en 2020, le temps d'acc√®s √† l'extincteur (25m) a permis au feu de se d√©velopper."
                },
                {
                    id: 111,
                    theme: 'CONSTRUCTION',
                    question: "Quelle est la pente minimale recommand√©e pour l'√©coulement des eaux de pluie sur une toile ?",
                    options: [
                        "5%",
                        "10%",
                        "15%",
                        "20%"
                    ],
                    correctAnswer: 2,
                    hint: "Cette pente √©vite la stagnation de l'eau et le risque d'effondrement.",
                    explanation: "La pente minimale recommand√©e est de 15% pour l'√©coulement des eaux.",
                    detailedExplanation: "Une pente inf√©rieure peut provoquer : accumulation d'eau, surcharge structurelle, risques de d√©chirure.",
                    reference: "DTU 43.1 - R√®gles de conception",
                    caseStudy: "En 2019, l'effondrement d'un chapiteau sous 30cm d'eau accumul√©e (pente de 8%)."
                },
                {
                    id: 112,
                    theme: 'MAT√âRIAUX',
                    question: "Quel classement au feu pour les d√©cors flottants (banderoles, draperies) ?",
                    options: [
                        "M0 obligatoire",
                        "M1 obligatoire",
                        "M2 minimum",
                        "M3 accept√©"
                    ],
                    correctAnswer: 1,
                    hint: "Les √©l√©ments suspendus pr√©sentent un risque particulier de propagation verticale.",
                    explanation: "Les d√©cors flottants doivent √™tre class√©s M1 (non inflammable).",
                    detailedExplanation: "Risque sp√©cifique : propagation rapide par les courants d'air chaud, difficult√© d'extinction.",
                    reference: "Article AM 11 - R√®glement de s√©curit√©",
                    caseStudy: "Incendie du th√©√¢tre de Nantes 2018 : propagation en 45 secondes via des banderoles M4."
                },
                {
                    id: 113,
                    theme: 'SECOURS',
                    question: "Combien d'exercices d'√©vacuation annuels sont obligatoires pour un CTS ?",
                    options: [
                        "1 exercice",
                        "2 exercices",
                        "3 exercices",
                        "4 exercices"
                    ],
                    correctAnswer: 0,
                    hint: "La fr√©quence d√©pend de la cat√©gorie de l'√©tablissement.",
                    explanation: "1 exercice d'√©vacuation annuel est obligatoire pour les CTS.",
                    detailedExplanation: "Cet exercice doit impliquer tout le personnel et faire l'objet d'un compte-rendu dans le registre de s√©curit√©.",
                    reference: "Article MS 46 - R√®glement de s√©curit√©",
                    caseStudy: "Lors d'un vrai incendie en 2021, le personnel form√© gr√¢ce aux exercices a √©vacu√© 300 personnes en 4 minutes."
                },
                {
                    id: 114,
                    theme: 'JURISPRUDENCE',
                    question: "Quelle amende maximale pour mise en danger de la vie d'autrui dans un CTS ?",
                    options: [
                        "15 000 ‚Ç¨",
                        "30 000 ‚Ç¨",
                        "75 000 ‚Ç¨",
                        "150 000 ‚Ç¨"
                    ],
                    correctAnswer: 3,
                    hint: "L'article 223-1 du Code p√©nal pr√©voit des peines s√©v√®res.",
                    explanation: "L'amende maximale est de 150 000 ‚Ç¨ pour mise en danger de la vie d'autrui.",
                    detailedExplanation: "Peines compl√©mentaires possibles : interdiction d'exercer, fermeture administrative, dommages-int√©r√™ts.",
                    reference: "Code p√©nal, article 223-1",
                    caseStudy: "Tribunal de Lille 2022 : 120 000 ‚Ç¨ d'amende + 2 ans avec sursis pour un chapiteau surcharg√© non conforme."
                },
                {
                    id: 115,
                    theme: '√âLECTRICIT√â',
                    question: "Quelle est la section minimale du conducteur de protection (terre) ?",
                    options: [
                        "√âgale aux conducteurs actifs",
                        "Moiti√© de la section des conducteurs actifs",
                        "2,5 mm¬≤ minimum",
                        "1,5 mm¬≤ minimum"
                    ],
                    correctAnswer: 0,
                    hint: "Le conducteur de protection doit pouvoir supporter le m√™me courant de d√©faut.",
                    explanation: "La section doit √™tre √©gale √† celle des conducteurs actifs.",
                    detailedExplanation: "Exception : si la section des actifs > 16 mm¬≤, la terre peut √™tre de 16 mm¬≤ minimum.",
                    reference: "NFC 15-100, tableau 54G",
                    caseStudy: "√âlectrocution en 2020 due √† une terre de section insuffisante qui a fondu."
                }
            ],
            expert: [
                {
                    id: 201,
                    theme: 'JURISPRUDENCE',
                    question: "Selon un arr√™t de la Cour de cassation, quelle est la faute caract√©ris√©e d'un responsable CTS ?",
                    options: [
                        "Ne pas avoir un SSIAP pr√©sent",
                        "Avoir d√©pass√© la jauge de 10%",
                        "Avoir utilis√© des mat√©riaux M2 au lieu de M1",
                        "Avoir omis de v√©rifier les certificats d'ignifugation"
                    ],
                    correctAnswer: 3,
                    hint: "La v√©rification des documents techniques est une obligation de moyen renforc√©e.",
                    explanation: "L'omission de v√©rification des certificats d'ignifugation constitue une faute caract√©ris√©e.",
                    detailedExplanation: "La jurisprudence consid√®re que le responsable doit v√©rifier personnellement la validit√© et l'authenticit√© des certificats.",
                    reference: "Cass. Crim. 15 janvier 2020, n¬∞ 19-82.456",
                    caseStudy: "Condamnation confirm√©e en appel : responsable technique ayant accept√© une toile avec certificat falsifi√©."
                },
                {
                    id: 202,
                    theme: 'MAT√âRIAUX',
                    question: "Quel est l'indice d'oxyg√®ne minimum pour un mat√©riau class√© M1 ?",
                    options: [
                        "IO ‚â• 21",
                        "IO ‚â• 28",
                        "IO ‚â• 35",
                        "IO ‚â• 42"
                    ],
                    correctAnswer: 1,
                    hint: "L'indice d'oxyg√®ne mesure la combustibilit√© d'un mat√©riau.",
                    explanation: "L'indice d'oxyg√®ne minimum est de 28 pour un mat√©riau class√© M1.",
                    detailedExplanation: "IO = pourcentage minimum d'oxyg√®ne n√©cessaire √† la combustion. Plus l'IO est √©lev√©, moins le mat√©riau est combustible.",
                    reference: "Norme NF EN ISO 4589-2",
                    caseStudy: "Mat√©riau pr√©sent√© comme M1 mais avec IO 24 : combustion spontan√©e √† 280¬∞C au lieu de 350¬∞C."
                },
                {
                    id: 203,
                    theme: 'SECOURS',
                    question: "Quel est le temps maximum d'√©vacuation calcul√© pour un chapiteau de 1000 places ?",
                    options: [
                        "4 minutes",
                        "6 minutes",
                        "8 minutes",
                        "10 minutes"
                    ],
                    correctAnswer: 2,
                    hint: "Le calcul inclut le temps de perception, de d√©cision et de mouvement.",
                    explanation: "Le temps maximum th√©orique est de 8 minutes pour 1000 personnes.",
                    detailedExplanation: "Calcul : 1000 personnes √∑ (3 sorties √ó 50 pers/min) = 6.7 min + 1.3 min de marge = 8 min.",
                    reference: "M√©thode de calcul SIA 81 - S√©curit√© incendie",
                    caseStudy: "Exercice r√©el : √©vacuation de 980 personnes en 7 minutes 45 avec un personnel bien form√©."
                },
                {
                    id: 204,
                    theme: 'CONSTRUCTION',
                    question: "Quelle est la pression de calcul pour les ancrages en zone √† vent extr√™me ?",
                    options: [
                        "500 Pa",
                        "750 Pa",
                        "1000 Pa",
                        "1500 Pa"
                    ],
                    correctAnswer: 3,
                    hint: "La pression varie selon la zone g√©ographique et l'altitude.",
                    explanation: "La pression de calcul est de 1500 Pa en zone √† vent extr√™me.",
                    detailedExplanation: "Cette pression correspond √† un vent de 160 km/h. Les ancrages doivent r√©sister √† cette pression + coefficient de s√©curit√©.",
                    reference: "Eurocode 1 - Actions sur les structures",
                    caseStudy: "Temp√™te de 2019 : seul le chapiteau calcul√© √† 1500 Pa a r√©sist√© aux rafales √† 155 km/h."
                },
                {
                    id: 205,
                    theme: '√âLECTRICIT√â',
                    question: "Quel est le courant de d√©faut maximum pour un DDR 30mA en CTS ?",
                    options: [
                        "15 mA",
                        "30 mA",
                        "100 mA",
                        "300 mA"
                    ],
                    correctAnswer: 1,
                    hint: "Le DDR doit d√©clencher avant que le courant ne devienne dangereux.",
                    explanation: "Le courant de d√©faut maximum est de 30 mA pour la protection des personnes.",
                    detailedExplanation: "√Ä 30 mA, le temps de d√©clenchement doit √™tre ‚â§ 40 ms pour √©viter la fibrillation cardiaque.",
                    reference: "NFC 15-100, article 411.3.3",
                    caseStudy: "D√©faillance d'un DDR calibr√© √† 100 mA : √©lectrisation grave avec arr√™t cardiaque √† 80 mA."
                },
                {
                    id: 206,
                    theme: 'S√âCURIT√â',
                    question: "Quelle est la densit√© de charge au feu maximale pour un local de CTS ?",
                    options: [
                        "200 MJ/m¬≤",
                        "400 MJ/m¬≤",
                        "600 MJ/m¬≤",
                        "800 MJ/m¬≤"
                    ],
                    correctAnswer: 2,
                    hint: "Cette valeur limite l'√©nergie calorifique potentiellement d√©gag√©e.",
                    explanation: "La densit√© maximale est de 600 MJ/m¬≤ pour un local de CTS.",
                    detailedExplanation: "Calcul bas√© sur la somme des pouvoirs calorifiques de tous les mat√©riaux pr√©sents.",
                    reference: "M√©thode de la charge au feu - Guide APSAD",
                    caseStudy: "Incendie ultra-rapide en 2021 : charge au feu de 850 MJ/m¬≤ due √† des d√©cors en polystyr√®ne."
                },
                {
                    id: 207,
                    theme: 'JURISPRUDENCE',
                    question: "Quelle est la prescription pour une action en responsabilit√© apr√®s un accident en CTS ?",
                    options: [
                        "3 ans",
                        "5 ans",
                        "10 ans",
                        "20 ans"
                    ],
                    correctAnswer: 2,
                    hint: "Le d√©lai est plus long pour les atteintes √† l'int√©grit√© physique.",
                    explanation: "La prescription est de 10 ans √† compter de la consolidation du dommage.",
                    detailedExplanation: "D√©lai sp√©cifique pour les atteintes √† l'int√©grit√© physique (article 2226 du Code civil).",
                    reference: "Code civil, article 2226",
                    caseStudy: "Victime d'un effondrement en 2010 a pu agir en 2019 apr√®s complications m√©dicales."
                },
                {
                    id: 208,
                    theme: 'MAT√âRIAUX',
                    question: "Quel est le taux d'√©mission de fum√©es maximum pour un mat√©riau class√© M1 ?",
                    options: [
                        "‚â§ 100",
                        "‚â§ 200",
                        "‚â§ 300",
                        "‚â§ 400"
                    ],
                    correctAnswer: 1,
                    hint: "Les fum√©es sont responsables de 80% des d√©c√®s dans les incendies.",
                    explanation: "Le taux maximum est de 200 pour un mat√©riau class√© M1.",
                    detailedExplanation: "Mesur√© par l'indice d'opacit√© des fum√©es (ISO 5659-2). Les fum√©es doivent √™tre non toxiques et peu opaques.",
                    reference: "Norme NF EN 13823 - Essai SBI",
                    caseStudy: "Mat√©riau M1 rejet√© : √©mission de fum√©es √† 350 avec toxicit√© √©lev√©e (CO √† 5000 ppm)."
                },
                {
                    id: 209,
                    theme: 'SECOURS',
                    question: "Quelle est la largeur efficace minimale d'une issue compte tenu du ph√©nom√®ne d'arc-boutement ?",
                    options: [
                        "Largeur nominale - 15 cm",
                        "Largeur nominale - 10 cm",
                        "Largeur nominale - 5 cm",
                        "Largeur nominale - 0 cm"
                    ],
                    correctAnswer: 0,
                    hint: "L'arc-boutement r√©duit la largeur utile lors d'une √©vacuation dense.",
                    explanation: "La largeur efficace est la largeur nominale moins 15 cm.",
                    detailedExplanation: "Ph√©nom√®ne d'arc-boutement : les √©paules des personnes cr√©ent un goulot d'√©tranglement m√™me dans une issue large.",
                    reference: "√âtude du CSTB - Mod√©lisation des flux de foule",
                    caseStudy: "Sortie de 1.20m nominale mais efficace √† 1.05m : r√©duction de 25% du d√©bit d'√©vacuation."
                },
                {
                    id: 210,
                    theme: 'CONSTRUCTION',
                    question: "Quel est le coefficient de s√©curit√© minimal pour les c√¢bles de tension d'un chapiteau ?",
                    options: [
                        "2",
                        "3",
                        "4",
                        "5"
                    ],
                    correctAnswer: 3,
                    hint: "Les c√¢bles sont soumis √† des efforts dynamiques et des facteurs d'usure.",
                    explanation: "Le coefficient de s√©curit√© minimal est de 4 pour les c√¢bles de tension.",
                    detailedExplanation: "Un c√¢ble de rupture √† 4000 kg doit √™tre utilis√© pour une tension de 1000 kg max.",
                    reference: "DTU 43.1 - R√®gles de calcul des structures tendues",
                    caseStudy: "Rupture de c√¢ble en 2018 : coefficient de 2.5 seulement, rupture √† 1800 kg pour une charge de 700 kg."
                }
            ]
        };

        // --- GESTION DU QUIZ ---
        let quizState = {
            questions: [],
            currentQuestionIndex: 0,
            score: 0,
            answers: [],
            startTime: null,
            timerInterval: null,
            totalSeconds: 0
        };

        // --- CONTENU P√âDAGOGIQUE ---
        const educationalContent = {
            caseStudies: [
                {
                    title: "Effondrement partiel de chapiteau - Toulouse 2019",
                    content: `
                        <div class="bg-white rounded-xl shadow-sm overflow-hidden border-l-4 border-red-500 border border-stone-200">
                            <div class="p-6">
                                <div class="flex items-center mb-4">
                                    <div class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-bold mr-3">
                                        Tribunal Correctionnel
                                    </div>
                                    <div class="text-sm text-stone-500">Toulouse, 15 juillet 2019</div>
                                </div>
                                <h4 class="text-xl font-bold mb-2">Effondrement partiel de chapiteau</h4>
                                <p class="text-stone-700 mb-4">
                                    Un chapiteau de 2000 places s'est partiellement effondr√© lors d'un festival suite √† des vents de 80 km/h.
                                    Les ancrages n'√©taient pas conformes √† la r√©glementation CTS.
                                </p>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <i class="fas fa-gavel text-red-500 mr-2"></i>
                                        <span class="font-bold">Condamnation :</span>
                                        <span class="ml-2">8 mois avec sursis</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-euro-sign text-red-500 mr-2"></i>
                                        <span class="font-bold">Amende :</span>
                                        <span class="ml-2">35 000 ‚Ç¨</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-user-injured text-red-500 mr-2"></i>
                                        <span class="font-bold">Bless√©s :</span>
                                        <span class="ml-2">12 bless√©s l√©gers</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                },
                {
                    title: "Incendie dans une tente d'exposition - Lyon 2021",
                    content: `
                        <div class="bg-white rounded-xl shadow-sm overflow-hidden border-l-4 border-orange-500 border border-stone-200">
                            <div class="p-6">
                                <div class="flex items-center mb-4">
                                    <div class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-bold mr-3">
                                        Cour d'Appel
                                    </div>
                                    <div class="text-sm text-stone-500">Lyon, 22 mars 2021</div>
                                </div>
                                <h4 class="text-xl font-bold mb-2">Incendie dans une tente d'exposition</h4>
                                <p class="text-stone-700 mb-4">
                                    Un d√©part de feu dans une installation √©lectrique provisoire a entra√Æn√© la destruction totale d'une tente de 800m¬≤.
                                    Absence de d√©tection incendie et extincteurs non accessibles.
                                </p>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <i class="fas fa-gavel text-orange-500 mr-2"></i>
                                        <span class="font-bold">Condamnation :</span>
                                        <span class="ml-2">1 an avec sursis</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-euro-sign text-orange-500 mr-2"></i>
                                        <span class="font-bold">Amende :</span>
                                        <span class="ml-2">50 000 ‚Ç¨</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                }
            ]
        };

        // --- FONCTIONS DE NAVIGATION ---
        function switchTab(tabId) {
            console.log("Changement d'onglet vers :", tabId);
            
            // Masquer tous les onglets
            document.querySelectorAll('.tab-content').forEach(el => {
                el.classList.remove('active');
            });
            
            // Afficher l'onglet s√©lectionn√©
            const tab = document.getElementById(tabId);
            if (tab) {
                tab.classList.add('active');
            }
            
            // Mettre √† jour les boutons de navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('border-orange-600', 'text-orange-600', 'border-emerald-600', 'text-emerald-600');
                btn.classList.add('border-transparent');
            });
            
            const activeBtn = document.getElementById('btn-' + tabId);
            if (activeBtn) {
                if (tabId === 'resultats') {
                    activeBtn.classList.add('border-emerald-600', 'text-emerald-600');
                } else {
                    activeBtn.classList.add('border-orange-600', 'text-orange-600');
                }
                activeBtn.classList.remove('border-transparent');
            }
            
            // Charger le contenu sp√©cifique si n√©cessaire
            if (tabId === 'cas_reels') {
                loadCaseStudies();
            }
            
            // Si on bascule vers les r√©sultats, afficher les r√©sultats
            if (tabId === 'resultats' && quizState.questions.length > 0) {
                showResults();
            }
        }

        function loadCaseStudies() {
            const container = document.getElementById('caseStudiesContent');
            if (!container) return;
            
            let html = '<div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">';
            
            educationalContent.caseStudies.forEach((caseStudy) => {
                html += caseStudy.content;
            });
            
            html += '</div>';
            
            // Ajouter l'analyse des causes
            html += `
                <div class="bg-stone-50 rounded-xl p-6 border border-stone-200">
                    <h3 class="text-2xl font-bold mb-6 flex items-center">
                        <i class="fas fa-search text-slate-700 mr-3"></i>
                        Analyse des Causes R√©currentes
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-bold text-lg mb-3">Causes Techniques</h4>
                            <ul class="space-y-2">
                                <li class="flex items-start">
                                    <i class="fas fa-times-circle text-red-500 mt-1 mr-2"></i>
                                    <span>Ancrages insuffisants ou mal r√©alis√©s</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-times-circle text-red-500 mt-1 mr-2"></i>
                                    <span>Installations √©lectriques non conformes NFC 15-100</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-times-circle text-red-500 mt-1 mr-2"></i>
                                    <span>Mat√©riaux non class√©s au feu (M1 obligatoire)</span>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-lg mb-3">Causes Organisationnelles</h4>
                            <ul class="space-y-2">
                                <li class="flex items-start">
                                    <i class="fas fa-times-circle text-red-500 mt-1 mr-2"></i>
                                    <span>Absence de contr√¥le des ancrages avant √©v√©nement</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-times-circle text-red-500 mt-1 mr-2"></i>
                                    <span>Personnel non form√© aux proc√©dures d'√©vacuation</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-times-circle text-red-500 mt-1 mr-2"></i>
                                    <span>Registre de s√©curit√© non tenu √† jour</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }

        function startQuiz() {
            // V√©rifier qu'au moins un th√®me est s√©lectionn√©
            if (quizConfig.selectedThemes.length === 0) {
                alert("Veuillez s√©lectionner au moins un th√®me pour le quiz.");
                return;
            }

            // G√©n√©rer les questions selon la configuration
            quizState.questions = generateQuizQuestions();
            
            if (quizState.questions.length === 0) {
                alert("Aucune question disponible avec la configuration actuelle. Veuillez ajuster les param√®tres.");
                return;
            }

            // Initialiser l'√©tat du quiz
            quizState.currentQuestionIndex = 0;
            quizState.score = 0;
            quizState.answers = [];
            quizState.startTime = new Date();
            quizState.totalSeconds = 0;

            // D√©marrer le timer
            startTimer();

            // Basculer vers l'onglet quiz
            switchTab('quiz');

            // Afficher la premi√®re question
            displayCurrentQuestion();
        }

        function generateQuizQuestions() {
            const allQuestions = [];
            
            // R√©cup√©rer les questions du niveau s√©lectionn√©
            const levelQuestions = questionsDatabase[quizConfig.level] || [];
            
            // Filtrer par th√®mes s√©lectionn√©s
            const filteredQuestions = levelQuestions.filter(q => 
                quizConfig.selectedThemes.some(theme => 
                    q.theme.toLowerCase().includes(theme.toLowerCase())
                )
            );
            
            // Si pas assez de questions, prendre toutes les questions du niveau
            const questionsPool = filteredQuestions.length >= quizConfig.questionCount 
                ? filteredQuestions 
                : levelQuestions;
            
            // M√©langer les questions
            const shuffledQuestions = [...questionsPool].sort(() => Math.random() - 0.5);
            
            // Prendre le nombre demand√© de questions
            return shuffledQuestions.slice(0, quizConfig.questionCount);
        }

        function displayCurrentQuestion() {
            const question = quizState.questions[quizState.currentQuestionIndex];
            if (!question) return;

            // Mettre √† jour les indicateurs
            document.getElementById('currentQuestion').textContent = 
                `${quizState.currentQuestionIndex + 1}/${quizState.questions.length}`;
            document.getElementById('questionsLeft').textContent = 
                quizState.questions.length - quizState.currentQuestionIndex - 1;
            
            // Mettre √† jour la progression
            const progress = ((quizState.currentQuestionIndex + 1) / quizState.questions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `${Math.round(progress)}%`;

            // Afficher la question
            document.getElementById('questionTheme').textContent = question.theme;
            document.getElementById('questionText').textContent = question.question;

            // Afficher les options
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option p-4 border border-stone-300 rounded-lg cursor-pointer hover:bg-stone-50 transition';
                optionElement.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full border border-stone-300 flex items-center justify-center mr-4 font-bold">
                            ${String.fromCharCode(65 + index)}
                        </div>
                        <div class="flex-1">${option}</div>
                    </div>
                `;
                
                optionElement.addEventListener('click', () => selectAnswer(index));
                optionsContainer.appendChild(optionElement);
            });

            // Cacher les feedbacks pr√©c√©dents
            document.getElementById('hintContainer').classList.add('hidden');
            document.getElementById('feedbackContainer').classList.add('hidden');
            document.getElementById('caseStudyContainer').classList.add('hidden');
            document.getElementById('referenceContainer').classList.add('hidden');

            // G√©rer les boutons de navigation
            document.getElementById('prevBtn').disabled = quizState.currentQuestionIndex === 0;

            // Mettre √† jour le score
            updateScoreDisplay();
        }

        function selectAnswer(selectedIndex) {
            const question = quizState.questions[quizState.currentQuestionIndex];
            const isCorrect = selectedIndex === question.correctAnswer;

            // Enregistrer la r√©ponse
            quizState.answers[quizState.currentQuestionIndex] = {
                questionId: question.id,
                selectedAnswer: selectedIndex,
                isCorrect: isCorrect,
                timeSpent: quizState.totalSeconds
            };

            if (isCorrect) {
                quizState.score++;
            }

            // Afficher le feedback
            showFeedback(question, selectedIndex, isCorrect);
            
            // Mettre √† jour le score
            updateScoreDisplay();
        }

        function showFeedback(question, selectedIndex, isCorrect) {
            // D√©sactiver toutes les options
            document.querySelectorAll('#quizOptions .quiz-option').forEach((option, index) => {
                option.style.pointerEvents = 'none';
                if (index === question.correctAnswer) {
                    option.classList.add('correct', 'border-emerald-500', 'bg-emerald-50');
                } else if (index === selectedIndex && !isCorrect) {
                    option.classList.add('incorrect', 'border-red-500', 'bg-red-50');
                }
            });

            // Afficher le feedback d√©taill√©
            const feedbackContainer = document.getElementById('feedbackContainer');
            feedbackContainer.innerHTML = `
                <div class="${isCorrect ? 'bg-emerald-50 border-emerald-500' : 'bg-red-50 border-red-500'} rounded-lg p-4 border-l-4 mb-4">
                    <div class="flex items-start">
                        <i class="fas ${isCorrect ? 'fa-check-circle text-emerald-600' : 'fa-times-circle text-red-600'} text-xl mr-3 mt-1"></i>
                        <div>
                            <h4 class="font-bold ${isCorrect ? 'text-emerald-800' : 'text-red-800'} mb-1">
                                ${isCorrect ? 'Bonne r√©ponse !' : 'R√©ponse incorrecte'}
                            </h4>
                            <p class="${isCorrect ? 'text-emerald-700' : 'text-red-700'} mb-2">
                                ${question.explanation}
                            </p>
                            ${question.detailedExplanation ? `
                                <div class="mt-3 p-3 bg-white rounded border ${isCorrect ? 'border-emerald-200' : 'border-red-200'}">
                                    <p class="font-semibold ${isCorrect ? 'text-emerald-800' : 'text-red-800'} mb-1">Explication d√©taill√©e :</p>
                                    <p class="text-sm ${isCorrect ? 'text-emerald-700' : 'text-red-700'}">${question.detailedExplanation}</p>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
            feedbackContainer.classList.remove('hidden');

            // Afficher l'√©tude de cas si disponible
            if (question.caseStudy) {
                const caseStudyContainer = document.getElementById('caseStudyContainer');
                caseStudyContainer.innerHTML = `
                    <p class="text-sm text-stone-700">${question.caseStudy}</p>
                `;
                caseStudyContainer.classList.remove('hidden');
            }

            // Afficher la r√©f√©rence si disponible
            if (question.reference) {
                const referenceContainer = document.getElementById('referenceContainer');
                referenceContainer.innerHTML = `
                    <p class="text-sm text-stone-600">${question.reference}</p>
                    ${question.link ? `<a href="${question.link}" target="_blank" class="text-sm text-blue-600 hover:underline inline-block mt-2">
                        <i class="fas fa-external-link-alt mr-1"></i>
                        Consulter le texte
                    </a>` : ''}
                `;
                referenceContainer.classList.remove('hidden');
            }
        }

        function updateScoreDisplay() {
            const currentQuestion = quizState.currentQuestionIndex + 1;
            const percentage = currentQuestion > 0 ? 
                Math.round((quizState.score / currentQuestion) * 100) : 0;
            
            document.getElementById('correctAnswers').textContent = quizState.score;
            document.getElementById('scorePercentage').textContent = `${percentage}%`;
        }

        function showHint() {
            const question = quizState.questions[quizState.currentQuestionIndex];
            if (!question) return;
            
            document.getElementById('hintText').textContent = question.hint;
            document.getElementById('hintContainer').classList.remove('hidden');
        }

        function previousQuestion() {
            if (quizState.currentQuestionIndex > 0) {
                quizState.currentQuestionIndex--;
                displayCurrentQuestion();
            }
        }

        function nextQuestionOrFinish() {
            if (quizState.currentQuestionIndex < quizState.questions.length - 1) {
                quizState.currentQuestionIndex++;
                displayCurrentQuestion();
            } else {
                finishQuiz();
            }
        }

        // --- TIMER ---
        function startTimer() {
            clearInterval(quizState.timerInterval);
            quizState.totalSeconds = 0;
            
            quizState.timerInterval = setInterval(() => {
                quizState.totalSeconds++;
                const minutes = Math.floor(quizState.totalSeconds / 60);
                const seconds = quizState.totalSeconds % 60;
                document.getElementById('globalTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function finishQuiz() {
            clearInterval(quizState.timerInterval);
            switchTab('resultats');
        }

        function showResults() {
            const totalQuestions = quizState.questions.length;
            const percentage = totalQuestions > 0 ? Math.round((quizState.score / totalQuestions) * 100) : 0;
            
            // Mettre √† jour les r√©sultats
            document.getElementById('finalScorePercentage').textContent = `${percentage}%`;
            document.getElementById('totalCorrectAnswers').textContent = quizState.score;
            document.getElementById('totalTimeTaken').textContent = formatTime(quizState.totalSeconds);
            document.getElementById('averageTime').textContent = totalQuestions > 0 ? 
                `${Math.round(quizState.totalSeconds / totalQuestions)}s` : '0s';
            
            // Mettre √† jour le certificat
            document.getElementById('certificateScore').textContent = `${percentage}%`;
            
            // Cr√©er le graphique de performance
            createPerformanceChart();
            
            // G√©n√©rer les conseils
            generateAdvice(percentage);
            
            // Afficher les r√©sultats
            document.getElementById('resultsContainer').classList.remove('hidden');
            document.getElementById('noResultsMessage').style.display = 'none';
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        function createPerformanceChart() {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            
            // Analyser les performances par th√®me
            const themeStats = {};
            quizState.questions.forEach((question, index) => {
                const answer = quizState.quizData.answers[index];
                if (!themeStats[question.theme]) {
                    themeStats[question.theme] = { correct: 0, total: 0 };
                }
                themeStats[question.theme].total++;
                if (answer && answer.isCorrect) {
                    themeStats[question.theme].correct++;
                }
            });
            
            const themes = Object.keys(themeStats);
            const percentages = themes.map(theme => {
                const stat = themeStats[theme];
                return stat.total > 0 ? Math.round((stat.correct / stat.total) * 100) : 0;
            });
            
            // D√©truire le graphique existant
            if (window.performanceChart) {
                window.performanceChart.destroy();
            }
            
            window.performanceChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: themes,
                    datasets: [{
                        label: 'Score par th√®me (%)',
                        data: percentages,
                        backgroundColor: [
                            'rgba(234, 88, 12, 0.7)',
                            'rgba(5, 150, 105, 0.7)',
                            'rgba(51, 65, 85, 0.7)',
                            'rgba(220, 38, 38, 0.7)',
                            'rgba(245, 158, 11, 0.7)'
                        ],
                        borderColor: [
                            '#ea580c',
                            '#059669',
                            '#334155',
                            '#dc2626',
                            '#f59e0b'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.raw}%`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function generateAdvice(scorePercentage) {
            const adviceList = document.getElementById('adviceList');
            adviceList.innerHTML = '';
            
            const advices = [];
            
            if (scorePercentage < 50) {
                advices.push(
                    '<li class="flex items-start"><i class="fas fa-book text-red-500 mt-1 mr-2"></i><span><strong>Revisez les bases :</strong> Consultez l\'arr√™t√© du 23 janvier 1985</span></li>',
                    '<li class="flex items-start"><i class="fas fa-graduation-cap text-red-500 mt-1 mr-2"></i><span><strong>Formation recommand√©e :</strong> Suivez une formation CTS de niveau initiation</span></li>',
                    '<li class="flex items-start"><i class="fas fa-file-contract text-red-500 mt-1 mr-2"></i><span><strong>√âtudiez les cas :</strong> Analysez les √©tudes de cas dans l\'onglet d√©di√©</span></li>'
                );
            } else if (scorePercentage < 75) {
                advices.push(
                    '<li class="flex items-start"><i class="fas fa-search text-orange-500 mt-1 mr-2"></i><span><strong>Approfondissez :</strong> √âtudiez les cas pratiques de jurisprudence</span></li>',
                    '<li class="flex items-start"><i class="fas fa-file-contract text-orange-500 mt-1 mr-2"></i><span><strong>Documentation :</strong> Consultez les normes NFC 15-500 et NF EN 13501-1</span></li>',
                    '<li class="flex items-start"><i class="fas fa-chart-line text-orange-500 mt-1 mr-2"></i><span><strong>Entra√Ænement :</strong> Refaites le quiz avec le niveau Expert</span></li>'
                );
            } else {
                advices.push(
                    '<li class="flex items-start"><i class="fas fa-crown text-emerald-500 mt-1 mr-2"></i><span><strong>Excellente ma√Ætrise :</strong> Pensez √† la formation continue</span></li>',
                    '<li class="flex items-start"><i class="fas fa-chart-line text-emerald-500 mt-1 mr-2"></i><span><strong>Veille r√©glementaire :</strong> Suivez les √©volutions jurisprudentielles</span></li>',
                    '<li class="flex items-start"><i class="fas fa-share-alt text-emerald-500 mt-1 mr-2"></i><span><strong>Partage :</strong> Formez vos coll√®gues aux bonnes pratiques CTS</span></li>'
                );
            }
            
            advices.forEach(advice => {
                adviceList.innerHTML += advice;
            });
        }

        function downloadCertificate() {
            const name = document.getElementById('certificateName').textContent;
            if (name === '[VOTRE NOM]' || name.trim() === '') {
                alert("Veuillez entrer votre nom dans le certificat avant de le t√©l√©charger.");
                document.getElementById('certificateName').focus();
                return;
            }
            
            alert(`Certificat g√©n√©r√© pour ${name}. Dans une version compl√®te, un PDF t√©l√©chargeable serait g√©n√©r√©.`);
        }

        function restartQuiz() {
            quizState.questions = [];
            quizState.currentQuestionIndex = 0;
            quizState.score = 0;
            quizState.answers = [];
            quizState.startTime = null;
            clearInterval(quizState.timerInterval);
            quizState.totalSeconds = 0;
            
            // R√©initialiser le timer
            document.getElementById('globalTimer').textContent = '00:00';
            
            switchTab('config');
            document.getElementById('resultsContainer').classList.add('hidden');
            document.getElementById('noResultsMessage').style.display = 'block';
        }

        // --- INITIALISATION ---
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Page charg√©e, initialisation...");
            
            // Initialiser la configuration
            initConfiguration();
            
            // Initialiser la date du certificat
            const now = new Date();
            document.getElementById('certificateDate').textContent = 
                `${now.getDate().toString().padStart(2, '0')}/${(now.getMonth() + 1).toString().padStart(2, '0')}/${now.getFullYear()}`;
            
            // Pr√©parer le champ nom du certificat
            const certificateName = document.getElementById('certificateName');
            certificateName.addEventListener('click', function() {
                if (this.textContent === '[VOTRE NOM]') {
                    this.textContent = '';
                }
            });
            
            certificateName.addEventListener('blur', function() {
                if (this.textContent.trim() === '') {
                    this.textContent = '[VOTRE NOM]';
                }
            });
            
            // Charger le contenu p√©dagogique initial
            loadCaseStudies();
            
            console.log("Initialisation termin√©e");
        });

    </script>
</body>
</html>
